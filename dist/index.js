import btnEventHandlers from"./popup";import Inputmask from"inputmask";const form=document.form,nameInput=document.form.name,emailInput=document.form.email,numberInput=document.form.phone,messageInput=document.form.message,invalidText=document.querySelectorAll(".invalid-text"),loader=document.getElementById("loader"),stateText=document.querySelector(".state-text");let validInput;btnEventHandlers();let im=new Inputmask({mask:"+375-99-999-99-99"});im.mask(numberInput);const validateEmail=e=>new RegExp("[a-z0-9]+@[a-z]+.[a-z]{2,3}").test(e),validateEmptyInput=()=>{validInput=!0;for(let e=0;e<form.length-1;e++)form[e].value||(form[e].classList.add("invalid"),invalidText[e].innerHTML="Заполните это поле",validInput=!1)},reset=()=>{for(let e=0;e<form.length-1;e++)form[e].classList.remove("invalid"),invalidText[e].innerHTML="",validInput=!0};function resultTextRequest(e,t){stateText.innerHTML=e,stateText.style.color=`${t}`}function isLoading(e){loader.style.display=e}form.onsubmit=e=>{if(e.preventDefault(),reset(),validateEmptyInput(),nameInput.value&&emailInput.value&&numberInput.value&&messageInput.value){if(!validateEmail(emailInput.value))return emailInput.classList.add("invalid"),void(invalidText[1].innerHTML="Неккоректный Email");isLoading("block"),resultTextRequest(""),async function(){const e=await fetch("http://localhost:9090/api/registration",{method:"POST",body:new FormData(form)}),t=await e.json();"error"===t.status?resultTextRequest("Произошла ошибка, попробуйте еще раз!","#ff0000"):"success"===t.status&&(resultTextRequest("Ваша заявка успешно отправлена!","#adff2f"),form.reset())}().finally(isLoading("none"))}};